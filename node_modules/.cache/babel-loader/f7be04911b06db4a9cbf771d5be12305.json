{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/user/new-frontend/online-store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _asyncToGenerator from\"C:/Users/user/new-frontend/online-store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/user/new-frontend/online-store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import\"./CartScreen.css\";import React from\"react\";//import ReactDOM from \"react-dom\";\nimport{useEffect}from\"react\";import{useSelector,useDispatch}from\"react-redux\";import{Link}from\"react-router-dom\";import StripeCheckout from'react-stripe-checkout';import axios from\"axios\";import{toast}from\"react-toastify\";// Components\nimport CartItem from\"../components/CartItem\";// Actions\nimport{addToCart,removeFromCart}from\"../redux/actions/cartActions\";import\"react-toastify/dist/ReactToastify.css\";//impor \"./styles.css\";\ntoast.configure();var CartScreen=function CartScreen(){var dispatch=useDispatch();var cart=useSelector(function(state){return state.cart;});var cartItems=cart.cartItems;useEffect(function(){},[]);var qtyChangeHandler=function qtyChangeHandler(id,qty){dispatch(addToCart(id,qty));};var removeFromCartHandler=function removeFromCartHandler(id){dispatch(removeFromCart(id));};var getCartCount=function getCartCount(){return cartItems.reduce(function(qty,item){return Number(item.qty)+qty;},0);};var getCartSubTotal=function getCartSubTotal(){return cartItems.reduce(function(price,item){return price+item.price*item.qty;},0).toFixed(2);};var price=getCartSubTotal();var _React$useState=React.useState({name:\"Tesla Roadster\",price:price,description:\"Cool car\"}),_React$useState2=_slicedToArray(_React$useState,1),product=_React$useState2[0];function handleToken(_x,_x2){return _handleToken.apply(this,arguments);}function _handleToken(){_handleToken=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(token,addresses){var response,status;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log({token:token,addresses:addresses});_context.next=3;return axios.post(\"https://backend-dos.herokuapp.com/cart\",{token:token,product:product});case 3:response=_context.sent;status=response.data.status;console.log(\"Response:\",response.data);if(status===\"success\"){toast(\"Success! Check email for details\",{type:\"success\"});}else{toast(\"Something went wrong\",{type:\"error\"});}case 7:case\"end\":return _context.stop();}}},_callee);}));return _handleToken.apply(this,arguments);};//console.log(price);\nreturn/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"cartscreen\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"cartscreen__left\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Shopping Cart\"}),cartItems.length===0?/*#__PURE__*/_jsxs(\"div\",{children:[\"Your Cart Is Empty \",/*#__PURE__*/_jsx(Link,{to:\"/\",children:\"Go Back\"})]}):cartItems.map(function(item){return/*#__PURE__*/_jsx(CartItem,{item:item,qtyChangeHandler:qtyChangeHandler,removeHandler:removeFromCartHandler},item.product);})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"cartscreen__right\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"cartscreen__info\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Subtotal (\",getCartCount(),\") items\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"$\",getCartSubTotal()]})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(StripeCheckout,{stripeKey:\"pk_test_51KNXCBIIQnKtwtkJ7y26OKUg6U2JAlMMqOjcMBn555yuTWEEU24g7Ulgi0dtm0b39QM4mAcfHgcoq9IsfvfcwDOQ00B4JaYIUd\",token:handleToken,billingAddress:true,shippingAddress:true,amount:price*100,name:\"Books\"})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{children:\"Checkout with M-Pesa\"})})]})]})});};export default CartScreen;","map":{"version":3,"sources":["C:/Users/user/new-frontend/online-store/src/screens/CartScreen.js"],"names":["React","useEffect","useSelector","useDispatch","Link","StripeCheckout","axios","toast","CartItem","addToCart","removeFromCart","configure","CartScreen","dispatch","cart","state","cartItems","qtyChangeHandler","id","qty","removeFromCartHandler","getCartCount","reduce","item","Number","getCartSubTotal","price","toFixed","useState","name","description","product","handleToken","token","addresses","console","log","post","response","status","data","type","length","map"],"mappings":"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","sourcesContent":["import \"./CartScreen.css\";\r\nimport React from \"react\";\r\n//import ReactDOM from \"react-dom\";\r\nimport { useEffect } from \"react\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { Link } from \"react-router-dom\";\r\nimport StripeCheckout from 'react-stripe-checkout';\r\nimport axios from \"axios\";\r\nimport { toast } from \"react-toastify\";\r\n// Components\r\nimport CartItem from \"../components/CartItem\";\r\n\r\n// Actions\r\nimport { addToCart, removeFromCart } from \"../redux/actions/cartActions\";\r\nimport \"react-toastify/dist/ReactToastify.css\"; \r\n//impor \"./styles.css\";\r\n\r\ntoast.configure();\r\n\r\n\r\n\r\nconst CartScreen = () => {\r\n  const dispatch = useDispatch();\r\n\r\n  const cart = useSelector((state) => state.cart);\r\n  const { cartItems } = cart;\r\n\r\n  useEffect(() => {}, []);\r\n\r\n  const qtyChangeHandler = (id, qty) => {\r\n    dispatch(addToCart(id, qty));\r\n  };\r\n\r\n  const removeFromCartHandler = (id) => {\r\n    dispatch(removeFromCart(id));\r\n  };\r\n\r\n  const getCartCount = () => {\r\n    return cartItems.reduce((qty, item) => Number(item.qty) + qty, 0);\r\n  };\r\n\r\n  const getCartSubTotal = () => {\r\n    return cartItems\r\n      .reduce((price, item) => price + item.price * item.qty, 0)\r\n      .toFixed(2);\r\n  };\r\n\r\n  const price = getCartSubTotal();\r\n\r\n  const [product] = React.useState({\r\n    name: \"Tesla Roadster\",\r\n    price: price,\r\n    description: \"Cool car\"\r\n  });\r\n  async function handleToken(token, addresses) {\r\n\t  console.log({ token, addresses });\r\n\t  const response = await axios.post(\r\n\t\t\"https://backend-dos.herokuapp.com/cart\",\r\n\t\t{ token, product }\r\n\t  );\r\n\t  const { status } = response.data;\r\n\t  console.log(\"Response:\", response.data);\r\n\t  if (status === \"success\") {\r\n\t\ttoast(\"Success! Check email for details\", { type: \"success\" });\r\n\t  } else {\r\n\t\ttoast(\"Something went wrong\", { type: \"error\" });\r\n\t  }\r\n  };\r\n  \r\n  //console.log(price);\r\n\r\n  return (\r\n    <>\r\n      <div className=\"cartscreen\">\r\n        <div className=\"cartscreen__left\">\r\n          <h2>Shopping Cart</h2>\r\n\r\n          {cartItems.length === 0 ? (\r\n            <div>\r\n              Your Cart Is Empty <Link to=\"/\">Go Back</Link>\r\n            </div>\r\n          ) : (\r\n            cartItems.map((item) => (\r\n              <CartItem\r\n                key={item.product}\r\n                item={item}\r\n                qtyChangeHandler={qtyChangeHandler}\r\n                removeHandler={removeFromCartHandler}\r\n              />\r\n            ))\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"cartscreen__right\">\r\n          <div className=\"cartscreen__info\">\r\n            <p>Subtotal ({getCartCount()}) items</p>\r\n            <p>${getCartSubTotal()}</p>\r\n          </div>\r\n          <div>\r\n            <StripeCheckout\r\n\t\t\tstripeKey=\"pk_test_51KNXCBIIQnKtwtkJ7y26OKUg6U2JAlMMqOjcMBn555yuTWEEU24g7Ulgi0dtm0b39QM4mAcfHgcoq9IsfvfcwDOQ00B4JaYIUd\" \r\n\t\t\ttoken={handleToken}\r\n\t\t\tbillingAddress\r\n\t\t\tshippingAddress\r\n\t\t\tamount={price * 100}\r\n\t\t\tname=\"Books\"\r\n\t\t\t/>\r\n          </div>\r\n\t\t  <div>\r\n            <button>Checkout with M-Pesa</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default CartScreen;\r\n"]},"metadata":{},"sourceType":"module"}